APP_FULL_NAME="LZ4 is lossless compression algorithm"
APP_NAME="lz4"
APP_SHA="b6eab6461977dca11e7efc4ed79d59924b216c7e"
APP_VERSION="r131"
APP_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}${APP_NAME}-${APP_VERSION}.tar.gz"
APP_CONFIGURE_SCRIPT="no-conf"
APP_EXPORTS="lz4 lz4c lz4cat"
APP_REQUIREMENTS="gmake"
APP_MAKE_METHOD="gmake -s"
APP_INSTALL_METHOD="gmake install -s"

if [ "${SYSTEM_NAME}" = "FreeBSD" ]; then
    APP_COMPILER_ARGS="-std=c99 -Wall -Wextra -Wundef -Wshadow -Wcast-align -Wcast-qual -Wstrict-prototypes -pedantic -DXXH_NAMESPACE=LZ4_"
    APP_AFTER_UNPACK_CALLBACK="fix_makefile"
    fix_makefile () {
        for f in $(${FIND_BIN} ./ -name Makefile -type f -print 2>/dev/null); do
            note "Hacking file: $f"
            ${SED_BIN} -i '' -e 's/kFreeBSD/& FreeBSD/' "${f}"
            ${SED_BIN} -i '' -e 's/sudo//' "${f}"
        done
        ${SED_BIN} -e '/^all:/s/$$/ liblz4.pc/' lib/Makefile
        ${SED_BIN} -e '/^all:/s|fullbench.*||' programs/Makefile
    }
fi
