DEF_FULL_NAME="Python 3"
DEF_SHA="b7f832e6d84b406db4c854e3eb46411e6931bc98"
DEF_NAME="Python"
DEF_POSTFIX="35"
DEF_VERSION="3.5.1"
DEF_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.tgz"
DEF_REQUIREMENTS="pkgconf make zlib xz lzma sqlite bzip2 yaml libffi readline libressl"
DEF_CONFIGURE_ARGS="--enable-shared --with-threads --with-fpectl --without-pydebug --enable-ipv6 --with-doc-strings --with-ensurepip=upgrade ac_cv_posix_semaphores_enabled=yes ac_cv_opt_olimit_ok=no OPT="
if [ "${SYSTEM_NAME}" = "Darwin" ]; then
    DEF_CONFIGURE_ARGS="${DEF_CONFIGURE_ARGS} --enable-universalsdk --with-universal-archs=64-bit"
fi
DEF_AFTER_INSTALL_CALLBACK="${LN_BIN} -s ${PREFIX}/bin/pip3 ${PREFIX}/bin/pip ; ${PREFIX}/bin/pip install --upgrade pip ; ${PREFIX}/bin/pip install pytoml dulwich sqlalchemy; install_mysql_connector"
DEF_EXPORTS="python3 python3-config easy_install pip dulwich pytoml pip pip3"
DEF_USEFUL="bin/python*"
DEF_CONFLICTS_WITH="Python"

install_mysql_connector () {
    export CONNECTOR_VER=2.1.3
    mkdir /tmp/work 2>/dev/null
    cd /tmp/work
    ${FETCH_BIN} "https://dev.mysql.com/get/Downloads/Connector-Python/mysql-connector-python-${CONNECTOR_VER}.tar.gz"
    tar zxvf mysql-connector-python-${CONNECTOR_VER}.tar.gz
    cd mysql-connector-python-${CONNECTOR_VER}
    ${PREFIX}/bin/python3 setup.py install || \
        ${PREFIX}/bin/python setup.py install
}
