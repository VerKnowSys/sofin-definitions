inherit php56

DEF_FULL_NAME="PHP 7.2"
DEF_SHA="4fd355950fdbe39cdab1b2bac03f25160bd441ec"
DEF_VERSION="7.2.11"
DEF_SUFFIX="72"
DEF_SOURCE_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.tar.xz"
DEF_BUNDLED_EXTENSIONS="xdebug imagick geoip memcached"
DEF_NO_MPROTECT=YES # JIT enabled
DEF_NO_PAGEEXEC=YES # JIT enabled
DEF_APPLY_LOWER_SECURITY_ON="${DEF_EXPORTS}"

install_geoip () {
    geoip_name="geoip-1.1.1"
    geoip_archive="${geoip_name}.tgz"
    run "${FETCH_BIN} \"${MAIN_SOURCE_REPOSITORY}${geoip_archive}\" ${FETCH_OPTS}" && \
    run "${TAR_BIN} xf ${geoip_archive}" && \
    cd ${geoip_name} && \
    run "${PREFIX}/bin/phpize" && \
    run "./configure --prefix=${PREFIX} --with-php-config=${PREFIX}/bin/php-config --with-geoip=${PREFIX}" && \
    run "PATH=${PREFIX}/bin:$PATH make install" && \
    note "Installed PECL extension: ${geoip_name}" && \
    return 0
    return 1
}

install_xdebug () {
    arch_name="xdebug-2.6.0"
    archive="${arch_name}.tgz"
    run "${FETCH_BIN} ${MAIN_SOURCE_REPOSITORY}${archive} ${FETCH_OPTS}" && \
    run "${TAR_BIN} xf ${archive}" && \
    cd "${arch_name}" && \
    run "${PREFIX}/bin/phpize" && \
    run "./configure --prefix=${PREFIX} --enable-xdebug --with-php-config=${PREFIX}/bin/php-config" && \
    run "PATH=${PREFIX}/bin:$PATH make install" && \
    note "Installed Xdebug pecl module: ${arch_name}" && \
    return 0
    return 1
}
