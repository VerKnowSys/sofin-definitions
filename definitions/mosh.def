DEF_FULL_NAME="Mobile shell"
DEF_NAME="mosh"
DEF_SHA="421c28210b9e8834c91589421a1a686575258afa"
DEF_VERSION="1.2.6"
DEF_SOURCE_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.tar.gz"
DEF_REQUIREMENTS="pkgconf libressl protobuf perl"
DEF_CONFIGURE_ARGS="--enable-hardening --without-ncurses"
DEF_USEFUL="bin/perl*"
DEF_EXPORTS="mosh-client mosh-server mosh"

if [ "${SYSTEM_NAME}" = "FreeBSD" ]; then
    DEF_CONFIGURE_ARGS="${DEF_CONFIGURE_ARGS} --with-utempter"
    DEF_AFTER_INSTALL_METHOD="patch_mosh_bin"
    patch_mosh_bin () {
        ${SED_BIN} -i '' -e "s|#\!/usr/bin/env |#\!${PREFIX}/bin/|" ${PREFIX}/bin/mosh
    }
fi
