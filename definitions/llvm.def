DEF_DISABLE_ON="Linux"
DEF_FULL_NAME="Low Level Virtual Machine"
DEF_SHA="e0c48c4c182424b99999367d688cd8ce7876827b"
DEF_NAME="llvm"
DEF_VERSION="3.8.1"
DEF_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.src.tar.xz"
DEF_REQUIREMENTS="make bzip2 xz libffi libxml2 python27 ccache cmake"
DEF_CONFIGURE_ARGS="-DLLVM_INCLUDE_EXAMPLES=off -DLLVM_INCLUDE_TESTS=off -DLLVM_ENABLE_RTTI=on -DLLVM_ENABLE_FFI=on -DFFI_INCLUDE_DIR=${PREFIX}/include -DFFI_LIBRARY_DIR=${PREFIX}/lib -DLLVM_TARGETS_TO_BUILD=X86 -DLLVM_INSTALL_UTILS=on -DLLVM_OPTIMIZED_TABLEGEN=on" # LLVM_TOOL_LLDB_BUILD LLVM_TOOL_LLD_BUILD:BOOL
DEF_CONFIGURE="cmake"
DEF_CMAKE_BUILD_DIR="../"
DEF_EXPORTS="FileCheck not lli-child-target bugpoint c-index-test clang clang++ clang-cpp clang-tblgen idle llc lli llvm-ar llvm-as llvm-bcanalyzer llvm-config llvm-cov llvm-diff llvm-dis llvm-dwarfdump llvm-extract llvm-ld llvm-lto llvm-link llvm-mc llvm-nm llvm-objdump llvm-prof llvm-ranlib llvm-readobj llvm-rtdyld llvm-size llvm-stress llvm-stub llvm-tblgen macho-dump opt llvm-symbolizer llvm-split llvm-profdata llvm-PerfectShuffle llvm-pdbdump llvm-mcmarkup llvm-lib llvm-dwp llvm-dsymutil llvm-cxxdump llvm-c-test yaml-bench"
DEF_USEFUL="bin/llvm*"
DEF_USELESS="lib/perl* include/python* lib/python* share man"

DEF_AFTER_UNPACK_METHOD="make_builddir"
make_builddir () {
    ${MKDIR_BIN} -p build
    cd build
}
DEF_AFTER_INSTALL_METHOD="go_up"
go_up () {
    # Cmake build can.. skip FileCheck installation, just because
    ${INSTALL_BIN} -v bin/FileCheck ${PREFIX}/bin/FileCheck
    cd ..
}
