DEF_FULL_NAME="Pkg-Config"
DEF_NAME="pkgconf"
DEF_SHA="6cddb69aa93e1a216bc2716e3824d9edf7f89d89"
DEF_VERSION="1.1.0"
DEF_SOURCE_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.tar.xz"
DEF_EXPORTS="pkgconf pkg-config"
DEF_CONFIGURE_ARGS="--with-pkg-config-dir=${PREFIX}/lib/pkgconfig:/usr/libdata/pkgconfig --with-system-libdir=/usr/lib --with-system-includedir=/usr/include"

DEF_NO_LLVM_LINKER=YES
DEF_AFTER_MAKE_METHOD="patch_tests"
patch_tests () {
    ${SED_BIN} -i '' -e "s|\$(SHELL) tests/run.sh ./\$(PROG)|\$(SHELL) tests/run.sh ${BUILD_DIR}/${DEF_NAME}-${DEF_VERSION}/${DEF_NAME}|" Makefile
    return 0
}
DEF_AFTER_INSTALL_METHOD="hack_symlink"
hack_symlink () {
    try "${TEST_BIN} -x ${PREFIX}/bin/pkg-config" || \
        try "${LN_BIN} -s ${PREFIX}/bin/pkgconf ${PREFIX}/bin/pkg-config"
    return 0
}
