inherit llvm

DEF_FULL_NAME="${DEF_FULL_NAME} + LLVM Linker"
DEF_CONFIGURE_ARGS="${DEF_CONFIGURE_ARGS} -DLLVM_ENABLE_LIBCXX=on -DLLVM_TOOL_LLDB_BUILD=on -DLLVM_TOOL_LLD_BUILD=on -DLLVM_ENABLE_CXX1Y=on"
DEF_EXPORTS="${DEF_EXPORTS} ld lld ld.lld lldb clang clang++"
DEF_VERSION="4.0.0"
DEF_GIT_CHECKOUT="release_40"
DEF_SOURCE_PATH="https://github.com/llvm-mirror/llvm"
DEF_USELESS="share doc lib/python* lib/cmake"

DEF_AFTER_UNPACK_METHOD="prepare_lld"
prepare_lld () {
    cd tools
    try "${GIT_BIN} clone -b ${DEF_GIT_CHECKOUT} https://github.com/llvm-mirror/lld"
    cd ..
}

DEF_AFTER_INSTALL_METHOD="symlink_names"
symlink_names () {
    case "${SYSTEM_NAME}" in
        Darwin)
            # Darwin name:
            try "${LN_BIN} -vs \"${PREFIX}/bin/lld\" \"${PREFIX}/bin/ld\""
            ;;

        *)
            # UNIX name:
            try "${LN_BIN} -vs \"${PREFIX}/bin/lld\" \"${PREFIX}/bin/ld.lld\""
            try "${LN_BIN} -vs \"${PREFIX}/bin/lld\" \"${PREFIX}/bin/ld\""
            ;;
    esac
    return 0
}
