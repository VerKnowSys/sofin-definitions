APP_FULL_NAME="Net-SNMP library"
APP_NAME="net-snmp"
APP_SHA="97dc25077257680815de44e34128d365c76bd839"
APP_VERSION="5.7.3"
APP_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}${APP_NAME}-${APP_VERSION}.tar.gz"
APP_REQUIREMENTS="m4 gmake perl autoconf libtool automake"
APP_CONFIGURE_ARGS="--srcdir=\"${CACHE_DIR}cache/${APP_NAME}-${APP_VERSION}-${RUNTIME_SHA}/${APP_NAME}-${APP_VERSION}\" --enable-internal-md5 --with-default-snmp-version=3 --with-sys-contact=\"admin@verknowsys.com\" --with-sys-location=/Services/Net-snmp --with-logfile=/Services/Net-snmp/log/snmpd.log --with-persistent-directory=/Services/Net-snmp/var --with-gnu-ld --without-libwrap ${ADDITIONAL} --disable-embedded-perl --without-perl-modules --without-dmalloc --disable-manuals"
APP_MAKE_METHOD="gmake -s"
APP_INSTALL_METHOD="gmake install"
APP_NO_CCACHE="YES"
APP_EXPORTS="agentxtrap encode_keychange net-snmp-config net-snmp-create-v3-user snmpbulkget snmpbulkwalk snmpdelta snmpdf snmpget snmpgetnext snmpinform snmpnetstat snmpset snmpstatus snmptable snmptest snmptranslate snmptrap snmpusm snmpvacm snmpwalk snmpd snmptrapd"

if [ "${SYSTEM_NAME}" = "FreeBSD" ]; then
    APP_AFTER_UNPACK_CALLBACK="patch_sources"
    APP_LINKER_ARGS="-L${CACHE_DIR}cache/${APP_NAME}-${APP_VERSION}-${RUNTIME_SHA}/${APP_NAME}-${APP_VERSION}/snmplib/.libs -L/lib -L/usr/lib -L${PREFIX}/lib -lm -lcrypto -lkvm -ldevstat"
fi

patch_sources () {
    ${SED_BIN} -i '' -e 's!utmp_p->ut_name!utmp_p->ut_user!' ./agent/mibgroup/host/hr_system.c
    ${SED_BIN} -i '' -E -e 's|return pci_lookup_name|disabled broken|g' ./configure
    ${TOUCH_BIN} ./configure.ac
    ${PREFIX}/bin/autoreconf
}
