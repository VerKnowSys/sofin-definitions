DEF_DISABLE_ON="Darwin"
DEF_FULL_NAME="OpenLDAP server"
DEF_SHA="016a738d050a68d388602a74b5e991035cdba149"
DEF_NAME="slapd"
DEF_VERSION="2.4.44"
DEF_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}openldap-${DEF_VERSION}.tgz"
DEF_CONFIGURE_ARGS="--enable-dynamic --with-tls=openssl --enable-overlays=mod --enable-modules --enable-slapd --enable-sock --with-threads=posix --with-mp=gmp --disable-dependency-tracking --enable-hdb=yes --enable-bdb=yes --disable-mdb --sysconfdir=${SERVICE_DIR}/etc --localstatedir=${SERVICE_DIR}/var"
DEF_REQUIREMENTS="gmake m4 libtool gmp51 db47 libressl"
DEF_USEFUL="bin/db_*"
DEF_USELESS="lib/*perl* include/python* lib/python* man share docs"
DEF_EXPORTS="slapd ldapadd ldapcompare ldapdelete ldapexop ldapmodify ldapmodrdn ldappasswd ldapsearch ldapurl ldapwhoami slapacl slapadd slapauth slapcat slapdn slapindex slappasswd slapschema slaptest"

patch_configure () {
    # HACK: db dependency seems to be completely fine, but configure script insists to say it's broken:
    ${SED_BIN} -i '' -e 's#if test $ol_cv_bdb_compat != yes ; then#if test $ol_cv_bdb_compat != no ; then#g' ./configure
    true
}
DEF_AFTER_UNPACK_CALLBACK="patch_configure"
