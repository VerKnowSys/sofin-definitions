DISABLE_ON="Darwin Linux"
APP_FULL_NAME="OpenLDAP server"
APP_SHA="016a738d050a68d388602a74b5e991035cdba149"
APP_NAME="slapd"
APP_VERSION="2.4.44"
APP_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}openldap-${APP_VERSION}.tgz"
APP_CONFIGURE_ARGS="--enable-dynamic --with-tls=openssl --enable-overlays=mod --enable-modules --enable-slapd --enable-sock --with-threads=posix --with-mp=gmp --disable-dependency-tracking --enable-hdb=yes --enable-bdb=yes --disable-mdb --sysconfdir=${SERVICE_DIR}/etc --localstatedir=${SERVICE_DIR}/var"
APP_REQUIREMENTS="gmake m4 libtool gmp51 db47 libressl"
APP_USEFUL="bin/db_*"
APP_USELESS="lib/*perl* include/python* lib/python* man share docs"
APP_EXPORTS="slapd ldapadd ldapcompare ldapdelete ldapexop ldapmodify ldapmodrdn ldappasswd ldapsearch ldapurl ldapwhoami slapacl slapadd slapauth slapcat slapdn slapindex slappasswd slapschema slaptest"

patch_configure () {
    # HACK: db dependency seems to be completely fine, but configure script insists to say it's broken:
    ${SED_BIN} -i '' -e 's#if test $ol_cv_bdb_compat != yes ; then#if test $ol_cv_bdb_compat != no ; then#g' ./configure
}
APP_AFTER_UNPACK_CALLBACK="patch_configure"
