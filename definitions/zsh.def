DEF_FULL_NAME="Z Shell"
DEF_NAME="zsh"
DEF_SHA="ec2a98c080f213c1c6c465c0c64662b5eae6818f"
DEF_VERSION="5.3.1"
DEF_SOURCE_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.tar.xz"
DEF_CONFIGURE_ARGS="--disable-dynamic --disable-dynamic-nss --enable-pcre --enable-cap --enable-multibyte --with-tcsetpgrp --enable-multibyte --enable-stack-allocation --disable-maildir-support --enable-zsh-secure-free --enable-gdbm --enable-fndir=${PREFIX}/share/zsh/functions --enable-scriptdir=${PREFIX}/share/zsh/scripts --enable-site-fndir=${PREFIX}/share/zsh/site-functions --enable-site-scriptdir=${PREFIX}/share/zsh/site-scripts --enable-runhelpdir=${PREFIX}/share/zsh/help"
DEF_REQUIREMENTS="pkgconf make m4 libedit zlib bzip2 pcre libtool gdbm db"
DEF_TEST_METHOD="make ${MAKE_OPTS} -s check"
DEF_USELESS="share/aclocal share/libtool share/readline"
DEF_EXPORTS="zsh sh"

case "${SYSTEM_NAME}" in
    FreeBSD)
        DEF_COMPILER_ARGS="-Wl,-static -I${PREFIX}/include"
        DEF_LINKER_ARGS="-static -L${PREFIX}/lib"
        DEF_CONFIGURE_ARGS="${DEF_CONFIGURE_ARGS} --with-term-lib=\"tinfow tinfo\" --disable-dynamic --disable-dynamic-nss"
        DEF_USELESS="${DEF_USELESS} include lib" # not required for static build
        DEF_INSTALL_METHOD="install_method"
        install_method () {
            make -s install
            ${TEST_BIN} -L "${PREFIX}/bin/sh" || ${LN_BIN} -s "${PREFIX}/bin/zsh" "${PREFIX}/bin/sh"
        }
        ;;

    Darwin)
        DEF_COMPILER_ARGS="-Wl,-L${PREFIX}/lib"
        ;;
esac
