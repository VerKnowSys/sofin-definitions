APP_FULL_NAME="Erlang OTP"
APP_SHA="4397f29801fd430ef7e9ff03ea814807bf954e20"
APP_NAME="erlang"
APP_VERSION="18.2.1"
APP_POSTFIX="18"
APP_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}otp_src_${APP_VERSION}.tar.gz"
APP_REQUIREMENTS="gmake perl libressl"
APP_MAKE_METHOD="gmake -s ${MAKE_OPTS}"
APP_INSTALL_METHOD="gmake install -s && install_repl_history"
APP_CONFIGURE_ARGS="--enable-threads --enable-kernel-poll --disable-silent-rules --enable-smp-support --enable-sctp --enable-hipe --with-ssl=${PREFIX} --without-javac --enable-native-libs --disable-debug --enable-dynamic-ssl-lib --enable-shared-zlib"
if [ "${SYSTEM_NAME}" != "Linux" ]; then
    APP_CONFIGURE_ARGS="${APP_CONFIGURE_ARGS} --with-dynamic-trace=dtrace"
fi
APP_EXPORTS="ct_run dialyzer epmd erl erlc escript run_erl to_erl typer"
APP_CONFLICTS_WITH="Erlang"

install_repl_history() {
    ${GIT_BIN} clone https://github.com/ferd/erlang-history.git
    cd erlang-history
    PATH=$PATH:${PREFIX}/bin:/bin gmake install
}
