inherit php73

DEF_FULL_NAME="PHP 8"
DEF_SUFFIX="8"
DEF_VERSION="8.0.7"
DEF_SHA="1c1af07d790a85103863e9818def633c737010e2"
DEF_SOURCE_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.tar.xz"
DEF_ORIGIN="https://www.php.net/distributions/${DEF_NAME}-${DEF_VERSION}.tar.xz"
DEF_BUNDLED_EXTENSIONS="decimal apcu xdebug memcached redis igbinary" # NOTE: meminfo doesn't build for 8 yet
DEF_REQUIREMENTS="libzip @curl libxslt geoip libmemcached gmp zip pcre2-jit onig libnet t1lib @fontconfig jpeg libpng tiff jbig2dec jbigkit libjpeg-turbo libmcrypt libsodium mpdecimal icu libedit libuuid postgresql11-client mariadb-client re2c phc-winner-argon2"

# NOTE: Php8 doesn't build with external gd (--enable-gd --with-external-gd=shared,${PREFIX}) cause:
#
#   ld.lld: error: undefined symbol: zif_imagecreatefromxpm
# and/or
#   undefined symbol: find_in_given_path
#
DEF_CONFIGURE_ARGS="--disable-all --disable-static --disable-debug --disable-cgi --disable-phpdbg --disable-phpdbg-webhelper --disable-phpdbg-debug --enable-ipv6 --with-zip=shared --enable-mysqlnd --enable-sockets=shared --enable-soap=shared --enable-json=shared --enable-xml --enable-xmlwriter=shared --enable-xmlreader=shared --enable-simplexml=shared --enable-exif=shared --enable-pcntl=shared --enable-posix=shared --enable-ftp=shared --enable-calendar=shared --enable-bcmath=shared --enable-wddx=shared --enable-tokenizer=shared --enable-session=shared --enable-hash --enable-filter=shared --enable-mbstring=shared --enable-fileinfo=shared --enable-dom=shared --enable-gd-native-ttf --enable-opcache=shared --enable-sysvshm=shared --enable-sysvmsg=shared --enable-sysvsem=shared --enable-shmop=shared --enable-phar --enable-embed=shared --enable-cli --enable-fpm --enable-litespeed --enable-pdo=shared --enable-gettext=shared --enable-dba=shared --with-pdo-mysql=shared,${PREFIX} --with-pdo-pgsql=shared,${PREFIX} --with-zlib=shared --with-bz2=shared --with-pic --with-iconv --with-layout=GNU --with-system-tzdata --with-password-argon2=shared,${PREFIX} --with-libxml=shared,${PREFIX} --with-openssl=shared,${PREFIX} --with-openssl-dir=${PREFIX} --with-mcrypt=shared --with-mysqli=mysqlnd --with-pgsql=shared --with-curl=shared --with-gmp=shared,${PREFIX} --with-pear --with-xmlrpc=shared --enable-ctype=shared --with-mhash=shared,${PREFIX} --with-jpeg=shared,${PREFIX} --with-xsl=shared,${PREFIX} --with-libedit=shared --with-external-pcre=${PREFIX} --enable-gd --with-freetype=shared --enable-freetype=shared --enable-fontconfig=shared --with-config-file-scan-dir=${SERVICE_DIR}/etc/php --with-libzip=shared --with-sodium=shared --enable-intl=shared ac_cv_sizeof_off_t=8 ac_cv_decimal_fp_supported=no ac_cv_func_RAND_egd=no lt_cv_path_SED=sed"
