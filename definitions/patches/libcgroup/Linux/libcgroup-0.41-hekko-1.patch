diff -ur libcgroup-0.41/src/api.c libcgroup-0.41-hekko-1//src/api.c
--- libcgroup-0.41/src/api.c	2014-01-13 15:05:56.000000000 +0100
+++ libcgroup-0.41-hekko-1/src/api.c	2015-08-20 19:19:56.000000000 +0200
@@ -4054,6 +4054,7 @@
 		 * readlink() fails if a kernel thread, and a process
 		 * name is taken from /proc/<pid>/status.
 		 */
+		strncpy(pname_status, "__KERNEL__", sizeof("__KERNEL__"));
 		*procname = pname_status;
 		return 0;
 	}
@@ -4090,10 +4091,10 @@
 	/*
 	 * The above strncmp() is not 0 also if executing a symbolic link,
 	 * /proc/pid/exe points to real executable name then.
-	 * Return it as the last resort.
+	 * As the last resort, return name from /proc/<pid>/status.
 	 */
+	*procname = strdup(pname_status);
 	free(pname_status);
-	*procname = strdup(buf);
 	if (*procname == NULL) {
 		last_errno = errno;
 		return ECGOTHER;
