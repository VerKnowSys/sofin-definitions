APP_FULL_NAME="MariaDB 10.1"
APP_STANDALONE="true"
APP_SHA="ea3b98d79f6c2af741f3819b3a77c96d6ab7a3fe"
APP_NAME="mariadb"
APP_VERSION="10.1.12"
APP_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}${APP_NAME}-${APP_VERSION}.tar.gz"
APP_REQUIREMENTS="pkgconf gmake zlib bzip2 m4 perl bison expat libiconv cmake ncurses libressl pcre lua51"
APP_CONFIGURE_SCRIPT="cmake"
APP_CONFIGURE_ARGS="-DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DENABLED_LOCAL_INFILE=off -DENABLE_DEBUG_SYNC=off -DWITH_UNIT_TESTS=off"
APP_EXPORTS="mysql mysql_config mysqld mysqld_multi mysqld_safe mysqladmin mysqlshow mysqlimport mysqlbinlog mysqldump mysqlaccess mysqlcheck mysqlhotcopy mysql_upgrade mysql_install_db msql2mysql myisamchk myisamlog myisampack mysqltest mysqlslap mysqlshow mysqldumpslow mysqlbug mysql_zap mysql_waitpid mysql_tzinfo_to_sql mysql_setpermission mysql_secure_installation mysql_plugin mysql_fix_extensions mysql_find_rows mysql_convert_table_format mysql_client_test my_print_defaults myisam_ftdump innochecksum aria_chk aria_dump_log aria_ftdump aria_pack aria_read_log mytop perror mysql-proxy"
APP_USELESS="share/bison share/gdb share/libtool doc sql-bench mysql-test support-files data share/cmake* man lib/*perl* lib/python* doc docs sql-bench mysql-test share/cmake* share/gtk* share/glib* share/man INSTALL-BINARY README COPYING"
APP_CONFLICTS_WITH="Percona Mysql"

case "${SYSTEM_NAME}" in
    Linux)
        APP_REQUIREMENTS="${APP_REQUIREMENTS} libffi gettext python27 libtool15 glib240 libevent flex"
        APP_AFTER_INSTALL_CALLBACK="after_build"
        after_build () {
            mysql_proxy_name="mysql-proxy"
            mysql_proxy_version="0.8.5"
            mysql_proxy_archive="${mysql_proxy_name}-${mysql_proxy_version}.tar.gz"
            ${FETCH_BIN} ${MAIN_SOURCE_REPOSITORY}${mysql_proxy_archive}
            tar xf ${mysql_proxy_archive}
            cd ${mysql_proxy_name}-${mysql_proxy_version}
            PKG_CONFIG_PATH=${PREFIX}/lib/pkgconfig:/usr/lib/pkgconfig PATH=${PREFIX}/bin:/bin:/usr/bin ./configure --prefix=${PREFIX}
            make install
        }
        ;;

    *)
        ;;
esac
