. ${DEFINITIONS_DIR}php56.def

APP_FULL_NAME="PHP 7"
APP_SHA="2f8c7988c5fe43d9aa9ad262db17d1994f6c7bc0"
APP_VERSION="7.0.4"
APP_POSTFIX="70"
APP_HTTP_PATH="${MAIN_SOURCE_REPOSITORY}${APP_NAME}-${APP_VERSION}.tar.xz"
APP_CONFIGURE_ARGS="--disable-all --with-libdir=${PREFIX}/lib --with-layout=PHP --with-libxml-dir=${PREFIX} --with-pcre-dir=${PREFIX} --with-zlib-dir=${PREFIX} --with-gettext=${PREFIX} --with-gd --with-png-dir=${PREFIX} --with-jpeg-dir=${PREFIX} --enable-exif --enable-zip --enable-mysqlnd --disable-debug --enable-fpm --enable-sockets --enable-soap --enable-json --enable-xml --enable-libxml --enable-dom --enable-cli --enable-session --enable-hash --enable-simplexml --enable-filter --enable-pdo --with-pdo-mysql=${PREFIX} --with-pdo-pgsql=${PREFIX} --enable-mbstring --enable-fileinfo --with-openssl --enable-intl --with-mcrypt=${PREFIX} --with-mysqli=mysqlnd --with-openssl-dir=${PREFIX} --with-pgsql=${PREFIX} --with-config-file-path=${PREFIX} --with-curl=${PREFIX} --with-gmp=${PREFIX} --with-freetype-dir=${PREFIX} --with-pear --with-xsl=${PREFIX} --enable-posix --with-bz2 --enable-ftp --enable-calendar --enable-bcmath --enable-wddx --enable-zip --enable-intl --with-xmlrpc --with-iconv --disable-maintainer-zts --enable-cgi --enable-ctype --with-mhash=${PREFIX} --enable-tokenizer --enable-xmlwriter --enable-xmlreader --with-pdo-sqlite=${PREFIX} --with-sqlite3=${PREFIX} --with-ldap=${PREFIX} --with-ldap-sasl=${PREFIX} --with-imap-ssl=${PREFIX} --with-imap=${PREFIX} --with-litespeed --enable-cgi --enable-opcache --enable-phar --disable-phpdbg-debug --disable-phpdbg-webhelper --disable-phpdbg"
APP_BUNDLED_EXTENSIONS="xdebug imagick" # rar geoip dbase
if [ "${SYSTEM_NAME}" = "Linux" ]; then
    APP_BUNDLED_EXTENSIONS="oci8 ${APP_BUNDLED_EXTENSIONS}"
fi

install_imagick () {
    arch_name="imagick-3.4.0RC6"
    archive="${arch_name}.tgz"
    ${FETCH_BIN} "${MAIN_SOURCE_REPOSITORY}${archive}" && \
    ${TAR_BIN} xf "${archive}" && \
    cd "${arch_name}" && \
    ${PREFIX}/bin/phpize && \
    ./configure --prefix=${PREFIX} --with-imagick=${PREFIX} && \
    PATH=${PREFIX}/bin:$PATH make install && \
    note "Installed IMagick pecl module" && \
    return 0
    return 1
}

install_oci8 () {
    arch_name="oci8-2.1.0"
    archive="${arch_name}.tgz"
    ${FETCH_BIN} "${MAIN_SOURCE_REPOSITORY}${archive}" && \
    ${TAR_BIN} xf "${archive}" && \
    cd "${arch_name}" && \
    ${PREFIX}/bin/phpize && \
    ./configure --prefix=${PREFIX} --with-oci8=instantclient,${PREFIX}/lib && \
    PATH=${PREFIX}/bin:$PATH make install && \
    note "Installed OCI8 pecl module: ${arch_name}" && \
    return 0
    return 1
}

install_xdebug () {
    arch_name="xdebug-2.4.0rc4"
    archive="${arch_name}.tgz"
    ${FETCH_BIN} "${MAIN_SOURCE_REPOSITORY}${archive}" && \
    ${TAR_BIN} xf "${archive}" && \
    cd "xdebug-2.4.0RC4" && \
    ${PREFIX}/bin/phpize && \
    ./configure --prefix=${PREFIX} --enable-xdebug --with-php-config=${PREFIX}/bin/php-config && \
    PATH=${PREFIX}/bin:$PATH make install && \
    note "Installed Xdebug pecl module: ${arch_name}" && \
    return 0
    return 1
}

# install_rar () {
#     arch_name="rar-3.0.2"
#     archive="${arch_name}.tgz"
#     ${FETCH_BIN} "${MAIN_SOURCE_REPOSITORY}${archive}" && \
#     ${TAR_BIN} xf "${archive}" && \
#     cd "${arch_name}" && \
#     ${PREFIX}/bin/phpize && \
#     ./configure --prefix=${PREFIX} --enable-rar --with-php-config=${PREFIX}/bin/php-config CFLAGS="-I${PREFIX}/include" && \
#     CFLAGS="-I${PREFIX}/include" PATH=${PREFIX}/bin:$PATH make install && \
#     note "Installed Rar pecl module: ${arch_name}" && \
#     return 0
#     return 1
# }
