DEF_FULL_NAME="OCaml"
DEF_SHA="831fab643feb0f78bd206f0a9a09a92df58838e7"
DEF_NAME="ocaml"
DEF_VERSION="4.06.0"
DEF_SOURCE_PATH="${MAIN_SOURCE_REPOSITORY}${DEF_NAME}-${DEF_VERSION}.tar.xz"
DEF_REQUIREMENTS="pkgconf make lzma xz lzo lz4 pcre libressl readline"
DEF_CONFIGURE_METHOD="posix"
DEF_CONFIGURE_OPTS="-no-ocamldoc -fPIC -safe-string -with-pthread -no-graph"
DEF_MAKE_METHOD="AR=ar make -s world.opt ${MAKE_OPTS}"
DEF_INSTALL_METHOD="make -s install"
DEF_EXPORTS="ocaml ocamlc camlp4r camlp4oof camlp4orf ocamlbuild ocamlcp ocamlrun camlp4 camlp4o camlp4of camlp4oof camlp4orf camlp4prof ocamldep ocamllex ocamlmklib ocamlmktop ocamlobjinfo ocamlyacc ocamlopt" # ocamldoc
DEF_USEFUL="bin/ocaml*"
DEF_STANDALONE=YES
DEF_NO_TRAP_INT_OVERFLOW=YES
DEF_NO_CCACHE=YES
DEF_USE_SAFE_STACK=YES

# NOTE: override Sofin compiler setup:
unset DEF_COMPILER_FLAGS DEF_LINKER_FLAGS CFLAGS CXXFLAGS LDFLAGS

CFLAGS="-O2 -w -Wl,-rpath=${PREFIX}/lib,--enable-new-dtags -fPIE ${HARDEN_SAFE_STACK_FLAGS}"
CXXFLAGS="-O2 -w -Wl,-rpath=${PREFIX}/lib,--enable-new-dtags -fPIE ${HARDEN_SAFE_STACK_FLAGS}"
LDFLAGS="-L${PREFIX}/lib -L/usr/lib -fPIE ${HARDEN_SAFE_STACK_FLAGS}"
LD="clang++"
